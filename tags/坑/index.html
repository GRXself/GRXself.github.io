
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="GRXself&#39;s blog">
    <title>Tag: 坑 - GRXself&#39;s blog</title>
    <meta name="author" content="GRXself">
    
    
    
    <script type="application/ld+json">{}</script>
    <meta name="description" content="personal blog">
<meta property="og:type" content="blog">
<meta property="og:title" content="GRXself&#39;s blog">
<meta property="og:url" content="https://grxself.github.io/tags/坑/index.html">
<meta property="og:site_name" content="GRXself&#39;s blog">
<meta property="og:description" content="personal blog">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="GRXself&#39;s blog">
<meta name="twitter:description" content="personal blog">
<meta name="twitter:creator" content="@GRXself">
    
    
        
    
    
        <meta property="og:image" content="https://tva2.sinaimg.cn/crop.116.23.429.429.180/82e78bccjw8enznr15gdwj20g40lh0tt.jpg"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-1udptkpril81ozu8ifd8zpujn7ipu7lefxsiu5gxx0dpnzntdx6dusvki3ao.min.css">
    <!--STYLES END-->
    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">GRXself&#39;s blog</a>
    </div>
    
        
            <a  class="header-right-picture "
                href="#about">
        
        
            <img class="header-picture" src="https://tva2.sinaimg.cn/crop.116.23.429.429.180/82e78bccjw8enznr15gdwj20g40lh0tt.jpg" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="1">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="https://tva2.sinaimg.cn/crop.116.23.429.429.180/82e78bccjw8enznr15gdwj20g40lh0tt.jpg" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">GRXself</h4>
                
                    <h5 class="sidebar-profile-bio"><p>404 NOT FOUND →)0v0 ）</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/ "
                            
                            title="Home"
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                            title="Categories"
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                            title="Tags"
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                            title="Archives"
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link open-algolia-search"
                             href="#search"
                            
                            title="Search"
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="#about"
                            
                            title="About"
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/atom.xml"
                            
                            title="RSS"
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-right">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2019/09/17/ASP-NET-Core-Model-Binding/">
                            ASP.NET Core Model Binding
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-09-17T15:17:48+08:00">
	
		    Sep 17, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/ASP-NET-Core/">ASP.NET Core</a>


    
</div>

            </div>
            
                <div class="postShorten-excerpt">
                    <p>I just begin learning vue, vuex and axios with my ASP.NET Core back end recent days. When I set all the thing good in my front end(vue, vuex and axios all went well) and sent a request with json data, the ASP.NET Core back end web api received nothing(Something indeed received, but the parameter roomId is set to zero, just see the code below).</p>
                    
                        <a href="/2019/09/17/ASP-NET-Core-Model-Binding/" class="postShorten-excerpt_link link">
                            Continue reading
                        </a>
                        
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2019/09/12/Tricky-Things-in-CORS/">
                            Tricky Things in CORS
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-09-12T13:57:23+08:00">
	
		    Sep 12, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/ASP-NET-Core/">ASP.NET Core</a>, <a class="category-link" href="/categories/Security/">Security</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="1-Basic-concept-about-CORS"><a href="#1-Basic-concept-about-CORS" class="headerlink" title="1. Basic concept about CORS"></a>1. Basic concept about CORS</h2><p>Cross-Origin Resource Sharing(CORS) is a mechanism that checks if there is a cross origin request comes up. It uses additional HTTP headers to help browsers determine whether this occurs.</p>
<h3 id="Same-origin"><a href="#Same-origin" class="headerlink" title="Same origin"></a>Same origin</h3><p>Two URLs have the same origin if they have identical schemes, hosts, and ports (<a href="https://tools.ietf.org/html/rfc6454" target="_blank" rel="noopener">RFC 6454</a>).</p>
<p>These two URLs shares the same origin:</p>
<ul>
<li><code>https://example.com/fake.html</code></li>
<li><code>https://example.com/another.html</code></li>
</ul>
<p>These URLs have different origins than the previous twos:</p>
<ul>
<li><code>https://example.net</code> - Different domain</li>
<li><code>https://www.example.com/fake.html</code> - Different subdomain</li>
<li><code>http://example.com/fake.html</code> - Different scheme(protocol)</li>
<li><code>http://example.com:5001/fake.html</code> - Different port</li>
</ul>
<h3 id="Additional-HTTP-headers-Thanks-to-this-article"><a href="#Additional-HTTP-headers-Thanks-to-this-article" class="headerlink" title="Additional HTTP headers (Thanks to this article)"></a>Additional HTTP headers (Thanks to this <a href="https://medium.com/@baphemot/understanding-cors-18ad6b478e2b" target="_blank" rel="noopener">article</a>)</h3><p>CORS uses a few HTTP headers — both in request and response — but the ones you must understand in order to be able to continue working are:</p>
<h4 id="Access-Control-Allow-Origin"><a href="#Access-Control-Allow-Origin" class="headerlink" title="Access-Control-Allow-Origin"></a>Access-Control-Allow-Origin</h4><p>This header is meant to be <code>returned by the server</code>, and indicate what client-domains are allowed to access its resources. The value can be:</p>
<ul>
<li><code>*</code> — allow any domain</li>
<li>a fully qualified domain name (eg. <a href="https://example.com" target="_blank" rel="noopener">https://example.com</a>)</li>
</ul>
<p>If you require the client to pass authentication headers (e.g. cookies) the value can not be <code>*</code> — it must be a fully qualified domain!</p>
<h4 id="Access-Control-Allow-Credentials"><a href="#Access-Control-Allow-Credentials" class="headerlink" title="Access-Control-Allow-Credentials"></a>Access-Control-Allow-Credentials</h4><p>This header is only required to be present in the response if your server supports authentication via cookies. The only valid value for this case is <code>true</code>.</p>
<h4 id="Access-Control-Allow-Headers"><a href="#Access-Control-Allow-Headers" class="headerlink" title="Access-Control-Allow-Headers"></a>Access-Control-Allow-Headers</h4><p>Provides a comma separated list of request header values the server is willing to support. If you use custom headers (eg. <code>x-authentication-token</code> you need to return it in this ACA header response to <code>OPTIONS</code> call, otherwise the request will be blocked.</p>
<h4 id="Access-Control-Expose-Headers"><a href="#Access-Control-Expose-Headers" class="headerlink" title="Access-Control-Expose-Headers"></a>Access-Control-Expose-Headers</h4><p>Similarly, this response should contain a list of headers that will be present in the actual response to the call and should be made available to the client. All other headers will be restricted.</p>
<h4 id="Access-Control-Allow-Methods"><a href="#Access-Control-Allow-Methods" class="headerlink" title="Access-Control-Allow-Methods"></a>Access-Control-Allow-Methods</h4><p>A comma separated list of HTTP request type verbs (eg. <code>GET</code>, <code>POST</code>) which the server is willing to support.</p>
<h4 id="Origin"><a href="#Origin" class="headerlink" title="Origin"></a>Origin</h4><p>This header is part of the request that the client is making, and will contain the domain from which the application is started. <code>For security reasons browsers will not allow you to overwrite this value.</code></p>
<h2 id="2-For-front-end"><a href="#2-For-front-end" class="headerlink" title="2. For front end"></a>2. For front end</h2><p>There is nothing front end DEV should do. The browser helps us check CORS policy, if you request an api that not been properly configured, you’ll see something like this:</p>
<img src="/2019/09/12/Tricky-Things-in-CORS/browserconsole1.png" title="chrome console">
<p>If you can not load the picture, here is the content:</p>
<p><code>Access to XMLHttpRequest at &#39;https://localhost:5001/api/products&#39; from origin &#39;http://localhost:8080&#39; has been blocked by CORS policy: No &#39;Access-Control-Allow-Origin&#39; header is present on the requested resource.</code></p>
<h2 id="3-For-back-end-One-tricky-here"><a href="#3-For-back-end-One-tricky-here" class="headerlink" title="3. For back end (One tricky here!)"></a>3. For back end (One tricky here!)</h2><p>Back end DEV should handle the request and confirm whether allow the origin to access the resource.</p>
<p>Taking ASP.NET Core as an example, you could follow this <a href="https://docs.microsoft.com/en-us/aspnet/core/security/cors?view=aspnetcore-2.2" target="_blank" rel="noopener">article</a> to configure CORS.</p>
<p>But it’s really tricky that back end still give its response with data even you set the CORS policy when using the ASP.NET Core 2.2 .</p>
<p>Let’s consider this problem, CORS middleware just set the headers. So a request from a NOT ALLOWED origin just receives the response without <code>Access-Control-Allow-Origin</code> included in its header. And then, the browser will give an error message, script can not read the response.(But browser do receive the respense with data).</p>
<h2 id="4-Tricky-thing-in-redirection"><a href="#4-Tricky-thing-in-redirection" class="headerlink" title="4. Tricky thing in redirection"></a>4. Tricky thing in redirection</h2><p>Back end CORS policy will check <code>Origin</code> in request header, making sure the <code>Origin</code> is configured in its policy. But when a redirection occurs, browser will set <code>Origin</code> to <code>null</code>. That means if you have configured specific origin policies, the <code>null Origin</code> will result in failure of policy check in back end. So the response header will not include <code>Access-Control-Allow-Origin</code> in its header. Browser will give an error and block script to read the response.</p>
<h2 id="5-One-extension"><a href="#5-One-extension" class="headerlink" title="5. One extension"></a>5. One extension</h2><h3 id="How-does-setting-Origin-to-null-in-a-redirected-CORS-request-protect-against-a-confused-deputy-attack"><a href="#How-does-setting-Origin-to-null-in-a-redirected-CORS-request-protect-against-a-confused-deputy-attack" class="headerlink" title="How does setting Origin to null in a redirected CORS request protect against a confused deputy attack?"></a><a href="https://security.stackexchange.com/questions/171711/how-does-setting-origin-to-null-in-a-redirected-cors-request-protect-against-a-c" target="_blank" rel="noopener">How does setting Origin to null in a redirected CORS request protect against a confused deputy attack?</a></h3><p>In the link above, Jonah Benton answered this question with a cool example, if you are interested in security problem, please read this.</p>
<p>In case the link goes down, I just paste the answer here:</p>
<p><code>That paragraph is tersely written, and the use of &quot;redirects to another resource at a new origin&quot; in the first sentence isn&#39;t quite right.</code></p>
<p><code>Here&#39;s a simple contrived example. Let&#39;s say you are malicious, and there is a web application that uses the services of a privileged API via CORS, so the web application&#39;s Origin is trusted by the privileged API. And let&#39;s say you want to get access to the data behind that privileged API, but your Origin of course is not trusted.</code></p>
<p><code>You create a simple useful service that you offer via CORS, and you get the web application to include your service in a page- any page- under its trusted Origin. That page does not need to access the privileged API.</code></p>
<p><code>(Of course, once you&#39;re in the page of your victim you can do whatever you want, but bear with me.)</code></p>
<p><code>If you decide to change your CORS service from issuing a 200 with some data to issue a 3xx to the privileged API- crossing resource domains- this creates a trust problem.</code></p>
<p><code>The actual Origin- the page that embedded your resource- will be trusted by the privileged API. But it didn&#39;t issue the request, and it may not want to be talking to the privileged API at this particular point in time.</code></p>
<p><code>Instead, you issued the redirect, and while you are trusted, in part, by the Origin, you are not trusted by the privileged API. If the browser follows your 3xx and sends along the Origin, you get to illegitimately piggy back on the trust given by the privileged API to the Origin.</code></p>
<p><code>What is the browser to do? A reasonable answer is to not follow the 3xx at all, but that would disallow use cases for which trust is not concern. Issuing the request with a &quot;null&quot; Origin allows those use cases, but prevents the exploitation of trust that sending along the original Origin header would allow.</code></p>

                    
                        

                    
                    
                        <p>
                            <a href="/2019/09/12/Tricky-Things-in-CORS/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2019/05/14/光驱异常导致的数据读取异常/">
                            光驱异常导致的数据读取异常
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-05-14T19:08:25+08:00">
	
		    May 14, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/硬件/">硬件</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>在遇到我之前写的这篇文章(<a href="https://grxself.github.io/2018/11/24/%E4%BD%BF%E7%94%A8zip4j%E9%81%87%E5%88%B0%E7%9A%84CRC%E9%94%99%E8%AF%AF%EF%BC%88invalid%20CRC%20for%20file%EF%BC%89%E2%80%94%E2%80%94%E2%80%94_%E5%AD%97%E7%AC%A6%E9%80%A0%E6%88%90%E7%9A%84%E5%BC%82%E5%B8%B8/">使用zip4j遇到的CRC错误（invalid CRC for file）———“_”字符造成的异常</a>)的问题之后，又遇到了其他字符出错的问题，这次我发现了这个项目中问题的根源。</p>
<p>此项目中接收并读取压缩包的电脑光驱存在问题，导致其在读取某些光盘是会出现乱码（文件系统的名字已经出现异常，本来是普通的中文名称，变成了类似于<code>__DS332S0</code>这样的名称，不管是文件夹还是里面的文件都是如此）此乱码造成的影响不只局限于名称，读取的文件也受到了影响。在正常的光驱中读取的数据无论是名称还是内容均正常，而此问题光驱最终导致了异常的发生。</p>
<p>最终的解决方案就是不再使用此光驱读取光盘中的数据，借用其他光驱读取后利用其他移动存储介质转移到此电脑后再使用。</p>

                    
                        

                    
                    
                        <p>
                            <a href="/2019/05/14/光驱异常导致的数据读取异常/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2019/05/14/Java Overflow and Underflow/">
                            Java Overflow and Underflow
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2019-05-14T18:03:00+08:00">
	
		    May 14, 2019
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/java/">java</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>今天在leetcode上做练习的时候遇到了一个<a href="https://leetcode-cn.com/problems/palindrome-number/solution/hui-wen-shu-by-leetcode/" target="_blank" rel="noopener">回文数的题</a>，考虑到不将整数转换为字符串来解决这个问题，我用求余把原整数倒序，然后跟原整数进行比较。</p>
<p>虽然我的做法通过了测试用例，也提交成功了，但是在我看官方题解时发现题解中考虑了直接倒序可能会出现临界情况，倒序的数可能会超过int的范围。官方题解中是只倒序了一半数字，然后对一半进行比较，所以没有涉及遇到边界的计算，但是我自己的solution涉及到了边界。</p>
<p>这里最大的问题是，我虽然没有考虑边界，但是却通过了测试。我开始以为是用例中没有包含边界，于是自己对边界进行了测试，但是实际测试之后才发现遇到边界之后java并没有抛出任何异常。</p>
<p>我对边界情况进行了调试，发现当一个边界内的数在数学运算之后超过边界后，其结果是可以预测的，但是却没有任何异常，也不是真正的数学运算结果。我在google和so上查找一番之后发现这种情况是数学运算之后，只有后32位的二进制数得到了保留。</p>
<p>在进一步的搜索之后，我找到了<a href="https://javapapers.com/core-java/java-overflow-and-underflow/" target="_blank" rel="noopener">这篇文章</a>,里面提到了Java Overflow And Underflow，而我遇见的情况就是overflow。</p>
<p>Java本身（我使用的是Java8）对这种overflow并没有任何runtime exception，所以这个问题只能靠自己去发现，需要保持警惕。</p>

                    
                        

                    
                    
                        <p>
                            <a href="/2019/05/14/Java Overflow and Underflow/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2018/11/24/使用zip4j遇到的CRC错误（invalid CRC for file）———_字符造成的异常/">
                            使用zip4j遇到的CRC错误（invalid CRC for file）———&#34;_&#34;字符造成的异常
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2018-11-24T21:56:00+08:00">
	
		    Nov 24, 2018
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/解压工具/">解压工具</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>今天遇到了一个棘手的解压问题，先描述一下大致的业务情况。压缩包是自己写的C#程序生成的（有加密），使用的是ICSharpCode.SharpZipLib，然后C#程序也可以解压这个加密的压缩包。这个加密的压缩包最终会上传到javaweb服务器上（springboot+tomcat+MySQL），javaweb项目使用的是zip4j。</p>
<p>结果客户提交上来的用C#程序生成的压缩包，无论是在C#程序上还是在java程序上都不能顺利解压（总共有200多文件夹，包含文件，但是解压到二十多个文件夹的时候出了问题）。</p>
<p>我尝试使用7Zip这个软件直接解压压缩包，发现压缩包可以正常解压，也不会报错。</p>
<p>在这之后我又使用我的C#程序对7Zip解压出来的文件重新进行压缩，然后发现我重新生成的文件在C#和java两边都能够正常解压。</p>
<p>难道是客户提交的压缩包有问题？但是7Zip解压的时候没有任何报错啊！</p>
<p>于是我开始在java程序那边打了断点进行调试，异常是：<code>net.lingala.zip4j.exception.ZipException: net.lingala.zip4j.exception.ZipException: invalid CRC for file: XXXX(此处省略文件名）</code></p>
<p>然后我在zip4j找到了两个讨论CRC问题的贴子<a href="http://www.lingala.net/zip4j/forum/index.php?topic=365.0" target="_blank" rel="noopener">#贴子1</a>、  <a href="http://www.lingala.net/zip4j/forum/index.php?topic=332.0" target="_blank" rel="noopener">#贴子2</a>，发现zip4j最新版本（1.3.2）确实存在CRC的bug。</p>
<p>但是奇怪的是C#版本为什么也会有类似的问题？于是我用7Zip的file manager查看了用户提交的压缩包（存在异常）和我自己重新生成的压缩包（一切正常），在仔细对比之后发现异常压缩包停止解压的文件名包含<code>_</code>，用file manager查看发现异常的压缩包文件名中的<code>_</code>显示为<code>?</code>，而正常的压缩包则正常显示<code>_</code>。</p>
<p>由于客户那边周末休假，所以无法得知客户对压缩包做过什么，也暂时无法获取用户的系统情况，但是我猜测可能是由于客户系统编码的原因导致<code>_</code>字符出现了异常，所以目前的解决方案是禁止客户在命名的时候使用<code>_</code>。</p>
<hr>
<p>2019-05-14更新：<br>此问题根源与zip4j无关，如需了解造成文中问题的根源请移步另一篇文章<a href="https://grxself.github.io/2019/05/14/光驱异常导致的数据读取异常/">光驱异常导致的数据读取异常</a></p>

                    
                        

                    
                    
                        <p>
                            <a href="/2018/11/24/使用zip4j遇到的CRC错误（invalid CRC for file）———_字符造成的异常/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/2018/06/13/初次使用dubbo框架遇见的坑/">
                            初次使用dubbo框架遇见的坑
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2018-06-13T16:08:37+08:00">
	
		    Jun 13, 2018
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/分布式系统/">分布式系统</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>按照dubbo首页的quick start入门，provider可以正常启动，但是consumer一直报错。<br>按照Demo写的代码运行Cunsummer时 <code>Failed to check the status of the service com.alibaba.dubbo.demo.DemoService</code>,找到了一个貌似指出问题的<a href="https://www.jianshu.com/p/3646263199a1" target="_blank" rel="noopener">blog</a>，里面提到</p>
<blockquote>
<p>根本原因是源码中会判断发送给consumer的服务消息是采用单播还是组播，因为虚拟网卡对ip地址的影响导致判断逻辑出错，误认为consumer可以接收到单播，但其实consumer在收到单播消息之前provider自己就把这个消息给抢着处理了（因为provider和consumer在同一台机器上，相当于provider自发自收），导致consumer无法获取服务消息。此问题在linux系统上实验时又无法复现，因为linux和windows的接口对待是否回环是不同的，linux下的consumer可以在provider之先获取到单播消息。</p>
</blockquote>
<p>并给出了解决方法：  </p>
<blockquote>
<p>1、禁用虚拟网卡。<br>2、在两台机器上分别部署<br>3、采用其它registry<br>4、将服务提供者的spring配置文件中改为(注意url后面的参数配置)<br><code>&lt;dubbo:registry address=&quot;multicast://224.5.6.7:1234?unicast=false&quot;/&gt;</code></p>
</blockquote>
<p>但是<strong>1、2、4在分别试过后都没用</strong>，最后我选择使用zookeeper来解决，也就是3中的方法，最后总算成功。但是dubbo首页给的方法真的很坑，muticast居然会报错，虽然根本原因<strong>可能是由windows系统引起的</strong>，以后需要仔细了解下多播，看看到底是怎么回事。</p>

                    
                        

                    
                    
                        <p>
                            <a href="/2018/06/13/初次使用dubbo框架遇见的坑/#post-footer" class="postShorten-excerpt_link link">
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">page 1 of 1</li>
    </ul>
</div>

</section>


                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2019 GRXself. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <img id="about-card-picture" src="https://tva2.sinaimg.cn/crop.116.23.429.429.180/82e78bccjw8enznr15gdwj20g40lh0tt.jpg" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">GRXself</h4>
        
            <div id="about-card-bio"><p>404 NOT FOUND →)0v0 ）</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>STUDENT</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker"></i>
                <br/>
                China-Xi&#39;an
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/script-yhuo2grt8r7qkqumzgjoglkfbicl1thukjgmla6jopu56zpcowfedi5zjcor.min.js"></script>
<!--SCRIPTS END-->



    </body>
</html>
